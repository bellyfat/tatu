define_plugin tatu
plugin_requires tatu designate
plugin_requires tatu barbican
plugin_requires tatu dragonflow # TODO(pino): remove this dependency

# Default options
TATU_USE_BARBICAN=${TATU_USE_BARBICAN:-"True"}
TATU_USE_PAT_BASTIONS=${TATU_USE_PAT_BASTIONS:-"True"}
TATU_TOTAL_PAT_BASTIONS=${TATU_TOTAL_PAT_BASTIONS:-2}
TATU_PAT_BASTIONS_PER_INSTANCE=${TATU_PAT_BASTIONS_PER_INSTANCE:-2}
TATU_DNS_ZONE_NAME=${TATU_DNS_ZONE_NAME:-example.com.}
TATU_DNS_ZONE_EMAIL=${TATU_DNS_ZONE_EMAIL:-"admin@admin"}

# Public facing bits
if is_service_enabled tls-proxy; then
    TATU_SERVICE_PROTOCOL="https"
fi

# Default IP/port settings
TATU_SERVICE_PROTOCOL=${TATU_SERVICE_PROTOCOL:-$SERVICE_PROTOCOL}
TATU_SERVICE_HOST=${TATU_SERVICE_HOST:-$SERVICE_HOST}
TATU_SERVICE_PORT=${TATU_SERVICE_PORT:-8322}
TATU_SERVICE_PORT_INT=${TATU_SERVICE_PORT_INT:-18322}

# Default directories
TATU_BIN_DIR=$(get_python_exec_prefix)
TATU_DIR=$DEST/tatu
TATUDASHBOARD_DIR=$DEST/tatu-dashboard
TATU_CONF_DIR=/etc/tatu
TATU_STATE_PATH=${TATU_STATE_PATH:=$DATA_DIR/tatu}
TATU_CONF=$TATU_CONF_DIR/tatu.conf
TATU_LOG_DIR=/var/log/tatu
TATU_AUTH_CACHE_DIR=${TATU_AUTH_CACHE_DIR:-/var/cache/tatu}
TATU_ROOTWRAP_CONF=$TATU_CONF_DIR/rootwrap.conf
TATU_APIPASTE_CONF=$TATU_CONF_DIR/api-paste.ini

# Default repositories
TATU_REPO=${TATU_REPO:-${GIT_BASE}/pinodeca/tatu.git}
TATU_BRANCH=${TATU_BRANCH:-master}

GITREPO["tatu-dashboard"]=${TATUDASHBOARD_REPO:-${GIT_BASE}/pinodeca/tatu-dashboard.git}
GITBRANCH["tatu-dashboard"]=${TATUDASHBOARD_BRANCH:-master}
GITDIR["tatu-dashboard"]=$DEST/tatu-dashboard

GITREPO["python-tatuclient"]=${TATUCLIENT_REPO:-${GIT_BASE}/pinodeca/python-tatuclient.git}
GITBRANCH["python-tatuclient"]=${TATUCLIENT_BRANCH:-master}
GITDIR["python-tatuclient"]=$DEST/python-tatuclient

# Turn on all Tatu services by default
enable_service tatu
enable_service tatu-api
